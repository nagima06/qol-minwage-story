<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Minimum Wage × Quality of Life — Korea 2008–2023</title>
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <style>
    :root { --bg:#0a0f1f; --ink:#eaf0ff; --muted:#a9b4d6; --card:#131b36; --accent:#6ea8fe; }
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;line-height:1.6}
    .wrap{max-width:1200px;margin:0 auto;padding:20px}
    header{position:sticky;top:0;background:linear-gradient(180deg, rgba(10,15,31,.95), rgba(10,15,31,.7));backdrop-filter:blur(6px);border-bottom:1px solid #223061; z-index: 10;}
    header .bar{display:flex;align-items:center;justify-content:space-between;max-width:1200px;margin:0 auto;padding:10px 16px}
    header a{color:var(--muted);text-decoration:none;margin-right:14px}
    header a:hover{color:var(--ink)}
    .hero{padding:56px 16px 24px}
    h1{margin:0 0 6px;font-size:32px}
    .tag{display:inline-flex;align-items:center;gap:8px;border:1px solid #2a376b;color:#cfe0ff;background:#0e1631;border-radius:999px;padding:2px 10px;font-size:12px}
    section{margin:28px 0;background:var(--card);border-radius:18px;padding:16px 16px;box-shadow:0 8px 28px rgba(0,0,0,.25)}
    h2{font-size:20px;margin:0 0 10px}
    p{color:var(--muted)}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    @media (max-width: 900px){ .grid{grid-template-columns:1fr} }
    .figure{height:420px;border-radius:14px;background:#0b132a}
    .note{font-size:12px;color:var(--muted)}
    .reveal{opacity:0;transform:translateY(12px);transition:all .6s ease}
    .reveal.show{opacity:1;transform:none}
    .btn{display:inline-flex;align-items:center;gap:8px;background:#0f1836;border:1px solid #2a376b;color:#dfe8ff;border-radius:10px;padding:10px 14px;text-decoration:none}
    .btn:hover{border-color:#6ea8fe}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    footer{color:var(--muted);text-align:center;margin:28px 0 40px}
    .iframe-box{width:100%;height:900px;border:0;border-radius:14px;overflow:auto}
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="row">
        <a href="#hero">Intro</a>
        <a href="#method">Methods</a>
        <a href="#findings">Findings</a>
        <a href="#downloads">Downloads</a>
      </div>
      <span class="tag">Option 4 · Data Story Website</span>
    </div>
  </header>

  <div class="wrap">
    <!-- HERO -->
    <section id="hero" class="hero reveal">
      <h1>Minimum Wage &amp; Quality of Life in Korea (2008–2023)</h1>
      <p><b>Hypothesis (H1).</b> A higher <i>real minimum wage</i> improves the <i>quality of life (QoL)</i> of low-income workers.</p>
      <div class="row">
        <span class="tag">Annual indicators 2008–2023</span>
      </div>
    </section>

    <!-- METHODS -->
    <section id="method" class="reveal">
      <h2>Study Design</h2>
      <div class="grid">
        <div>
          <p><b>QoL metrics.</b> Engel_Coeff_Pct (↓ better), HousingCost_Income_Ratio_Pct (↓), Stress_Index (↓), Disposable_Income_Real_ThousandKRW (↑), Leisure_Exp_Ratio_Pct (↑). We also construct a <b>composite QoL</b> by z-scoring the direction-aligned metrics (Engel_dir_z, Housing_dir_z, Stress_dir_z, Income_dir_z, Leisure_dir_z) and averaging.</p>
          <p><b>Analysis.</b> All years (2008–2023) are pooled to examine the QoL–wage relationship (scatter + OLS fit) using a real minimum-wage index derived from <code>MW_Growth_Pct</code>. We also compare <b>pre</b> (2008–2017) vs <b>post</b> (2018–2023) with a 95% CI for the mean difference.</p>
          <p class="note">Charts below load <code>fig/trend.json</code>, <code>fig/scatter.json</code>, <code>fig/ci.json</code>. If missing, demo charts are shown.</p>
        </div>
        <div class="figure" id="fig_trend"></div>
      </div>
    </section>

    <!-- FINDINGS -->
    <section id="findings" class="reveal">
      <h2>Key Findings</h2>
      <div class="grid">
        <div class="figure" id="fig_scatter"></div>
        <div>
          <p id="summary-text">
            <b>Summary.</b> Using all years pooled, the minimum wage–QoL association is positive. The post period (2018–2023) exceeds the pre period (2008–2017).
          </p>
          <ul class="note">
            <li>Left: QoL vs real minimum wage (OLS straight-line fit).</li>
            <li>Right: Pre–Post mean difference with 95% CI (bar + error bar).</li>
          </ul>
          <div class="figure" id="fig_ci" style="margin-top:8px;height:240px"></div>
        </div>
      </div>
    </section>

    <!-- DOWNLOADS (ZIP + Force download + Raw backup) -->
    <section id="downloads" class="reveal">
      <h2>Downloads</h2>
      <p>Materials for full reproducibility.</p>

      <!-- Force download via same-origin helper page -->
      <div class="row" style="gap:8px;margin-top:8px">
        <a class="btn" href="download.html?f=merged_for_plotly.csv">📊 Data CSV</a>
        <a class="btn" href="download.html?f=option2.ipynb">📖 Option 2 Notebook (.ipynb)</a>
        <a class="btn" href="download.html?f=option3.ipynb">📖 Option 3 Notebook (.ipynb)</a>
      </div>

      <p class="note" style="margin-top:6px">
        Note: JSON assets (<code>trend.json</code>, <code>scatter.json</code>, <code>ci.json</code>) are internal files for the charts and not intended for direct viewing.
      </p>
    </section>

    <footer class="reveal">
      <p>© 2025 Team QoL × MinWage · GitHub Pages</p>
    </footer>
  </div>

  <script>
    // Reveal on scroll
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('show'); io.unobserve(e.target);} });
    },{threshold:0.15});
    for(const el of document.querySelectorAll('.reveal')) io.observe(el);

    // Plotly loaders (use JSON if present; else demo)
    async function renderFig(id, file, fallback){
      try{
        const res = await fetch(file); if(!res.ok) throw new Error('no file');
        const {data, layout, config} = await res.json();
        Plotly.newPlot(id, data, layout, config || {responsive:true});
      }catch(err){ fallback(); }
    }

    // Auto-summary numbers from JSON (slope r and CI)
    async function updateSummary(){
      const el = document.getElementById('summary-text');
      let text = `<b>Summary.</b> Using all years pooled, the minimum wage–QoL association is positive.`;

      try {
        // slope & r from scatter.json (trace 0 = data points)
        const sc = await fetch('fig/scatter.json');
        if (sc.ok){
          const scj = await sc.json();
          const x = (scj.data?.[0]?.x || []).map(Number);
          const y = (scj.data?.[0]?.y || []).map(Number);
          if (x.length === y.length && x.length >= 2){
            const n = x.length;
            const mx = x.reduce((a,b)=>a+b,0)/n, my = y.reduce((a,b)=>a+b,0)/n;
            let num=0, dx2=0, dy2=0;
            for(let i=0;i<n;i++){ const dx=x[i]-mx, dy=y[i]-my; num+=dx*dy; dx2+=dx*dx; dy2+=dy*dy; }
            const b1 = num/dx2;
            const r  = num/Math.sqrt(dx2*dy2);
            text += ` OLS slope b₁ = <b>${b1.toFixed(3)}</b> (r = <b>${r.toFixed(3)}</b>).`;
          }
        }
        // diff & CI from ci.json
        const ci = await fetch('fig/ci.json');
        if (ci.ok){
          const cij = await ci.json();
          const y  = cij.data?.[0]?.y?.[0];
          const ey = (cij.data?.[0]?.error_y?.array||[null])[0];
          if (isFinite(y) && isFinite(ey)){
            const lo = y - ey, hi = y + ey;
            text += ` Post–Pre ΔQoL = <b>${y.toFixed(3)}</b> with 95% CI <b>[${lo.toFixed(3)}, ${hi.toFixed(3)}]</b>.`;
          }
        }
      } catch(e){ /* keep default wording */ }

      el.innerHTML = text + " The post period (2018–2023) exceeds the pre period (2008–2017).";
    }

    // Demo figures (fallback)
    function demoTrend(){
      const x=[2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023];
      const q=[-0.42,-0.02,0.05,-0.32,-0.36,-0.20,-0.13,-0.28,-0.17,0.34,0.65,0.69];
      const w=[6.3,6.4,6.6,6.8,7.0,7.5,8.3,8.7,8.6,8.9,9.1,9.3];
      const qn=q.map(v=> (v-Math.min(...q))/(Math.max(...q)-Math.min(...q)) );
      const wn=w.map(v=> (v-Math.min(...w))/(Math.max(...w)-Math.min(...w)) );
      Plotly.newPlot('fig_trend',
        [{x, y:qn, mode:'lines+markers', name:'QoL (norm)'},
         {x, y:wn, mode:'lines+markers', name:'Wage (norm)'}],
        {paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',
         margin:{l:50,r:20,t:30,b:40},xaxis:{title:'Year'},yaxis:{title:'Normalized (0–1)'}},
        {responsive:true});
    }
    function demoScatter(){
      const w=[6.3,6.4,6.6,6.8,7.0,7.5,8.3,8.7,8.6,8.9,9.1,9.3];
      const q=[-0.42,-0.02,0.05,-0.32,-0.36,-0.20,-0.13,-0.28,-0.17,0.34,0.65,0.69];
      const fit=x=>-2+0.28*x; const xs=[...Array(50)].map((_,i)=>6.2+i*(3.3/49)); const ys=xs.map(fit);
      Plotly.newPlot('fig_scatter',
        [{x:w,y:q,mode:'markers',name:'Data'},
        {x:xs,y:ys,mode:'lines',name:'fit',line:{dash:'dash'}}],
        {paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',
         margin:{l:50,r:20,t:30,b:40},xaxis:{title:'Real Min Wage (index)'},yaxis:{title:'QoL (index)'}},
        {responsive:true});
    }
    function demoCI(){
      Plotly.newPlot('fig_ci',
        [{x:['Post-Pre'],y:[0.18],type:'bar',error_y:{type:'data',array:[0.07],visible:true}}],
        {paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',margin:{l:50,r:20,t:10,b:30},yaxis:{title:'Mean diff (QoL)'}},
        {responsive:true});
    }

    // Kick off
    renderFig('fig_trend','fig/trend.json',demoTrend);
    renderFig('fig_scatter','fig/scatter.json',demoScatter);
    renderFig('fig_ci','fig/ci.json',demoCI);
    updateSummary();
  </script>
</body>
</html>

